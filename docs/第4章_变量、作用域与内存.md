# 第 4 章 变量、作用域与内存

本章内容：通过变量使用原始值与引用值、理解执行上下文、理解垃圾回收

相比于其他语言， JavaScript 中的变量可谓独树一帜。正如 ECMA-262 所规定的， JavaScript 变量是松散类型的，而且变量不过就是特定时间点一个特定值的名称而已。由于没有规则定义变量必须包含什么数据类型，变量的值和数据类型在脚本生命期内可以改变。这样的变量很有意思，很强大，当然也有不少问题。本章会剖析错综复杂的变量。

## 4.1 原始值与引用值

ECMAScript 变量可以包含两种不同类型的数据：原始值和引用值。 原始值（ primitive value）就是最简单的数据， 引用值（ reference value）则是由多个值构成的对象。

在把一个值赋给变量时， JavaScript 引擎必须确定这个值是原始值还是引用值。上一章讨论了 6 种原始值： Undefined、 Null、 Boolean、 Number、 String 和 Symbol。保存原始值的变量是按值（ by value）访问的，因为我们操作的就是存储在变量中的实际值。

引用值是保存在内存中的对象。与其他语言不同， JavaScript 不允许直接访问内存位置，因此也就不能直接操作对象所在的内存空间。在操作对象时，实际上操作的是对该对象的引用（ reference）而非实际的对象本身。为此，保存引用值的变量是按引用（ by reference）访问的。

> 注意 在很多语言中，字符串是使用对象表示的，因此被认为是引用类型。 ECMAScript打破了这个惯例。

### 4.1.1 动态属性

原始值和引用值的定义方式很类似，都是创建一个变量，然后给它赋一个值。不过，在变量保存了这个值之后，可以对这个值做什么，则大有不同。对于引用值而言，可以随时添加、修改和删除其属性和方法。比如，看下面的例子：
```javascript
let person = new Object();
person.name = "Nicholas";
console.log(person.name); // "Nicholas"
```
这里，首先创建了一个对象，并把它保存在变量 person 中。然后，给这个对象添加了一个名为